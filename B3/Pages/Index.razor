@page "/"
@inject GameService GameService

<h3>Lägg till Spelare</h3>
<form>
    <input type="text" @bind="NewPlayer" placeholder="Spelarens namn" />
    <button type="button" @onclick="AddPlayer">Lägg till</button>
</form>

<h3>Lägg till Gren</h3>
<form>
    <input type="text" @bind="NewEvent" placeholder="Gren" />
    <button type="button" @onclick="AddEvent">Lägg till</button>
</form>

<h3>Spelare</h3>
<ul>
    @foreach (var player in GameService.PlayerList)
    {
        <li>
            @player.Name
            <button type="button" @onclick="() => RemovePlayer(player)">Ta bort</button>
        </li>
    }
</ul>

<h3>Grenar</h3>
<ul>
    @foreach (var eventItem in GameService.EventList)
    {
        <li>
            @eventItem.Name
            <button type="button" @onclick="() => RemoveEvent(eventItem)">Ta bort</button>
        </li>
    }
</ul>

<h3>Tilldela spelare till gren</h3>
<form>
    <select @bind="SelectedPlayer">
        <option value="">Välj spelare</option>
        @foreach (var player in GameService.PlayerList)
        {
            <option value="@player.Name">@player.Name</option>
        }
    </select>
    <select @bind="SelectedEvent">
        <option value="">Välj gren</option>
        @foreach (var eventItem in GameService.EventList)
        {
            <option value="@eventItem.Name">@eventItem.Name</option>
        }
    </select>
    <button type="button" @onclick="AssignPlayerToEvent">Tilldela</button>
</form>


@code {
    private string NewPlayer;
    private string NewEvent;
    private string SelectedPlayer;
    private string SelectedEvent;

    private void AddPlayer()
    {
        GameService.PlayerList.Add(new Player { Name = NewPlayer, Score = 0 });
        NewPlayer = string.Empty;
    }

    private void AddEvent()
    {
        GameService.EventList.Add(new Event { Name = NewEvent });
        NewEvent = string.Empty;
    }

    private void RemovePlayer(Player player)
    {
        GameService.PlayerList.Remove(player);
    }

    private void RemoveEvent(Event eventItem)
    {
        GameService.EventList.Remove(eventItem);
    }

    private void AssignPlayerToEvent()
    {
        var selectedPlayer = GameService.PlayerList.FirstOrDefault(p => p.Name == SelectedPlayer);
        var selectedEvent = GameService.EventList.FirstOrDefault(e => e.Name == SelectedEvent);

        if (selectedPlayer != null && selectedEvent != null)
        {
            selectedPlayer.AssignedEvent = selectedEvent;
        }

        SelectedPlayer = string.Empty;
        SelectedEvent = string.Empty;
    }
}
